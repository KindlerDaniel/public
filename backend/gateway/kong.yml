_format_version: "3.0"
_transform: true

services:
  - name: auth-service
    url: http://authservice:4000
    routes:
      - name: auth-route
        paths:
          - /api/auth
        strip_path: true

  - name: media-service
    url: http://socialmedia-mediaservice:3001
    routes:
      - name: media-content-upload-route
        paths:
          - /api/media/content/upload-media
        strip_path: false
        preserve_host: true
      - name: media-content-api-route
        paths:
          - /api/media/content
        strip_path: false
        preserve_host: true
      - name: media-route
        paths:
          - /api/media
        strip_path: true
      - name: content-api-route
        paths:
          - /api/content
        strip_path: true

plugins:
  - name: cors
    config:
      origins:
        - "http://localhost:3000"
      methods:
        - GET
        - POST
        - PUT
        - DELETE
        - OPTIONS
      headers:
        - Authorization
        - Content-Type
        - X-Auth-Token
      exposed_headers:
        - X-Auth-Token
      credentials: true
      max_age: 3600